<!doctype html>
<head>
  <meta charset="utf-8">

  <title>CatFight!</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.12.min.js"></script>
<script type="text/javascript">
  Parse.initialize("3tHHUyxjtuSEiHranjliYJkJ36fEO89Ql77L2jng", "nY2YCI6Jn6ikyBWrjOxf3zj5bc8aPL5gvIUgGC5C");
</script>
</head>

<body>
  <div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    Parse.FacebookUtils.init({
      appId      : '424616640981705',                        // App ID from the app dashboard
      channelUrl : '//catfight.parseapp.com/channel.html', // Channel file for x-domain comms
      status     : true,                                 // Check Facebook Login status
	  cookie     : true, // enable cookies to allow Parse to access the session
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  <div id="main">
    
<script type="text/javascript">
        
    function loginToParse(username,password) {
        Parse.User.logIn(username, password, {
          success: function(user) {
            // Do stuff after successful login.
          },
          error: function(user, error) {
            // The login failed. Check error to see why.
          }
        });
    }
	function loginToFBThroughParse() {
		Parse.FacebookUtils.logIn("user_likes,email", {
		  success: function(user) {
			// Handle successful login
		  },
		  error: function(user, error) {
			// Handle errors and cancellation
		  }
		});
	}
	
	function getPic() {
		Parse.Cloud.run('getPic', {}, {
		  success: function(result) {
			$('#currentImage').attr('src',result.picUrl);
			$('#currentImageId').text(result.picId);
		  },
		  error: function(error) {
		  }
		});

	}
	
	function ratePic(decision) {
		Parse.Cloud.run('submitRating', {picId:$('#currentImageId').text(), rating: decision}, {
		  success: function(result) {
		  
		  },
		  error: function(error) {
		  }
		});
		getPic();
	}

</script>
    <div>
	<button onclick="#">Profile</button>
	<button onclick="loginToFBThroughParse()">Login</button>
	<br>
	<div id="imageDiv"><img id="currentImage"><p style="display:none" id="currentImageId"/></div>
    <button onclick="getPic()">GetPic</button>
	<button onclick="ratePic('up')">Upvote</button>
	<button onclick="ratePic('down')">Downvote</button>


    </div>
  </div>
</body>

</html>
